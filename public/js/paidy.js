/*! v3.1.0 */
!function(){function t(t){var e=a[t];a[t]=function(t){return n(e(t))}}function i(t,e,i){return(i=this).attachEvent("on"+t,function(t){(t=t||o.event).preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},e.call(i,t)})}function n(t,e){if(e=t.length)for(;e--;)t[e].addEventListener=i;else t.addEventListener=i;return t}var o,a;function s(t){window.setTimeout(function(){t&&t.call(document)})}o=window,a=document,o.addEventListener||(n([a,o]),"Element"in o?o.Element.prototype.addEventListener=i:(a.attachEvent("onreadystatechange",function(){n(a.all)}),t("getElementsByTagName"),t("getElementById"),t("createElement"),n(a.all))),"undefined"!=typeof window&&window.addEventListener("load",function(){var t;navigator.platform.match(/iPhone|iPod|iPad/)&&History.initCore&&(t=function(t){var i=t.func,n=t.limit,o=!1,a=[null,"",location.href];return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t[1]!==a[1]||t[2]!==a[2])return a=t,void i.apply(this,t);a=t,o||(i.apply(this,t),o=!0,setTimeout(function(){o=!1},n))}},History.pushState=t({func:History.pushState,limit:350}),History.replaceState=t({func:History.replaceState,limit:350}))},!1);var r=!1,d=[],e=function(){for(r=!0;d.length;)s(d.shift())};"undefined"!=typeof document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?r=!0:(document.addEventListener("DOMContentLoaded",e),document.addEventListener("load",e)));var c=(p=navigator.userAgent.toLowerCase()).match(/android (\d+(\.\d+)?)/),u=p.match(/firefox\/(\d+(\.\d+)?)/),e=p.match(/chrome\/(\d+(\.\d+)?)/),p=p.match(/msie (\d+(\.\d+)?)/),h=!!u,l=!!e,f=c?parseFloat(c[1]):null,m=p?parseFloat(p[1]):null;function _(){return f&&!l&&!h&&f<5?"お客様のご利用端末は、サポート対象外のOSバージョンのため2018年11月13日以降Paidy決済をご利用頂けません。サポート対象であるAndroid4.4以上のバージョンに更新していただくか、パソコン等（ブラウザ：IE11以上、Chrome、Firefox)をご使用いただくことで、Paidy決済をご利用いただけます。":m&&m<11?"お客様のブラウザバージョンは、サポート対象外のブラウザバージョンのため2018年11月13日以降Paidy決済をご利用頂けません。サポート対象であるIE11以上のバージョンに更新していただくか、他のブラウザ(Chrome、Firefox)をご使用いただくことで、Paidy決済をご利用いただけます。":0}var g=function(){var t=(new Date).getTime(),e=g.last||t,e=e<t?t:e+1;return g.last=e};function y(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),o=1;o<arguments.length;o++){var a=i[o];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])}return n}function v(t,e){return function(t,e){if(t.metadata=y({},e.metadata,t.metadata),e&&e.key&&0<=P.indexOf(e.key))try{var i=y({},t);if(t.buyer_data){var n=y({},t.buyer_data),o=n.shops;n.shops=[];for(var a=0;a<o.length;a+=1){var s=o[a],s=y({},{age:s.age,item_id:s.item_id,shop_id:s.shop_id,category:s.category,transaction_count:s.transaction_count},s.num_photos&&{num_photos:s.num_photos},s.buyer_shop_url&&{buyer_shop_url:s.buyer_shop_url},s.shop_name&&{shop_name:s.shop_name},s.total_sales_amount&&{total_sales_amount:s.total_sales_amount},s.shop_reputation&&{shop_reputation:s.shop_reputation},s.item_likes&&{item_likes:s.item_likes},s.item_reputation&&{item_reputation:s.item_reputation},s.num_of_follower&&{num_of_follower:s.num_of_follower});n.shops.push(s)}i.buyer_data=n}if(t.merchant_data){var r=y({},t.merchant_data),d=r.shops;r.shops=[];for(var c=0;c<d.length;c+=1){var u=d[c],u=y({},{age:u.age,item_id:u.item_id,shop_id:u.shop_id,category:u.category,transaction_count:u.transaction_count},u.num_photos&&{num_photos:u.num_photos},u.buyer_shop_url&&{buyer_shop_url:u.buyer_shop_url});r.shops.push(u)}i.merchant_data=r}return i}catch(t){}return t}(t,e)}function k(t){return t&&"[object Function]"==={}.toString.call(t)}function E(t){return k(t)?t:null}function w(){}function b(t,e,i){var n=this;void 0===e&&(e={}),this._id=i,this.options=e,this.state=j,this.iframeState=T,this.queue=[],this.iframe=document.createElement("iframe"),this.iframe.onload=function(){n.iframeState=F,n.dequeue()},e=(e=window.location.toString()).split("?")[1]&&"&"+e.split("?")[1]||"",this.iframe.src=t+"?key="+(this.options.apiKey||"")+e,this.iframe.setAttribute("style","z-index: 2147483647; display: none; position: fixed; background: transparent; top: 0; left: 0; width: 100%; height: 100%; border: 0; overflow-x: hidden; overflow-y: auto; visibility: visible; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent;"),_()||(e=function(){n.originalBodyPosition=window.getComputedStyle(document.body).getPropertyValue("position"),document.body.appendChild(n.iframe)},r?s(e):d.push(e))}var P=["pk_live_fipc8koosqqnt2dlq5ldponhki","pk_test_2pj0grk8pq462vgituhi4soupb","pk_live_ivrfsfmjbcj25v68bisol24f0t","pk_test_5a71qm1flhl4ien6j329eeejgq","NTdmNzU5ZDc0ODAwMDA3ODJiZWI2NDc3","pk_live_i2u2liovnsnhd7bv3lhkbj1ndj","pk_test_uusg55npaki2frlcpi094pqdnf","pk_live_sr1uq8ks2br5hg784k66p2ikvl","pk_test_p6p5kua3ec3ottsb4lnrmf0evk","pk_live_drgtc20a9sa7g6ruc1nqnpn4pd","pk_test_jpqok22b5rj5175nbsg5tp24pa","pk_live_qqac4cdri37qv0bpvpnpki73fi","pk_test_csi9hbenr716coapj57j9c7b12","NTczYzJhMWQ0NTAwMDBjZDBmMzlkMTlk"],D="production",O="paidy_checkout_style",S={production:"https://api.paidy.com"},C={production:"https://checkout-v2.paidy.com"},q={AUTHORIZED:"authorized",PENDING:"pending",REJECTED:"rejected",CLOSED:"closed"},N="active",L="recurring",T="initialized",F="loaded",I="closed",j="prepare",x="launch";function A(t){var i=this;this._id=g().toString(36).toUpperCase(),this.config={},this.configure(t),this.paidyFrame=new b(this.appHost,{apiKey:this.apiKey,onPending:this.onPending,onClose:this.onClose,isOnCloseV2:this.isOnCloseV2},this._id),this.wait=!1,window.addEventListener("message",function(t){var e=t.data;if(e&&e._id===i._id)switch(e.event){case"paidy_checkout:close":case"paidy_checkout:init_failed":i.paidyFrame&&i.paidyFrame.close(e.payload);break;case"paidy_checkout:payment_pending":i.paidyFrame&&i.paidyFrame.invokePending(e.payload)}},!1)}b.prototype.enqueue=function(t){this.queue.push(t),this.dequeue()},b.prototype.dequeue=function(){var t;this.iframeState!==F||(t=this.queue.shift())&&(k(t)&&t(this.iframe),this.dequeue())},b.prototype.reload=function(){this.iframeState=T,this.iframe.src=this.iframe.src},b.prototype.launch=function(n,t){var o=this;this.state!==x&&(this.state=x,this.config=y({},t),this.payload=n,this.enqueue(function(t){t.contentWindow.postMessage({_id:o._id,event:"paidy_checkout:init",config:JSON.stringify(o.config),payload:JSON.stringify(n)},t.src),o._iOSDevice=!!navigator.platform.match(/iPhone|iPod|iPad|iOS/),o._LIFF=!!navigator.userAgent.match(/LIFF/),o._LINE=!!navigator.userAgent.match(/Line/);var e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.id=O,i.appendChild(document.createTextNode("body { overflow: hidden !important; margin: 0 !important; padding: 0 !important; }")),e.appendChild(i),o._iOSDevice&&(o._LIFF||o._LINE)&&(t.style.position="absolute",t.style.top=document.documentElement.scrollTop+"px"),t.style.display="block"}))},b.prototype.invokePending=function(t){this.options.onPending&&this.options.onPending(t)},b.prototype.close=function(t){this.state=j;var e,i=!!this.payload.merchant_data,n=!!this.config&&!!this.config.token&&this.config.token.type===L;e=O,(e=document.getElementById(e))&&e.parentNode&&e.parentNode.removeChild(e),this._iOSDevice&&(document.body.style.position=this.originalBodyPosition),t=i?-1<[q.AUTHORIZED,q.PENDING].indexOf(t.status)&&{payment_id:t.id,status:function(t){var e=t.status;switch(e){case q.AUTHORIZED:return"authorize_success";case q.PENDING:return"pending_success";default:return e}}({status:t.status}),test:t.test}:(t.test&&delete t.test,n?t.status===N?{created_at:t.created_at,id:t.id,status:N}:this.options.isOnCloseV2&&{status:q.CLOSED}:-1<[q.AUTHORIZED,q.PENDING,q.REJECTED].indexOf(t.status)?t:{status:q.CLOSED}),this.iframe.style.display="none",t&&this.options.onClose(t),this.iframeState=I,this.reload()},A.prototype.configure=function(t){var e=t.key,i=t.api_key,n=t.api_host,o=t.app_host,a=t.tier,s=t.token,r=t.logo_url,d=t.metadata,c=t.on_pending,u=t.on_close,p=t.closed,t=t.callback;if(!i&&!e)throw new Error("[Paidy] Field 'key' or 'api_key' is required");var h,t=E(u)||E(p)||E(t)||w,u=k(u);this.config.key=i||e||"",this.config.api_host=n||S[D],this.config.app_host=o||C[D],this.config.tier=a,this.config.token=s,this.config.metadata=d,this.config.logo_url=r,this.config.on_pending=E(c),this.config.closed=(h=t,function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];setTimeout(function(){h.apply(void 0,t)},0)}),this.apiKey=this.config.key,this.apiHost=this.config.api_host,this.appHost=this.config.app_host,this.tier=this.config.tier,this.token=this.config.token,this.logoURL=this.config.logo_url,this.onPending=this.config.on_pending,this.onClose=this.config.closed,this.isOnCloseV2=u},A.prototype.launch=function(t){var e,i=this;this.wait||((e=_())&&alert(e),t=v(t,this.config),this.paidyFrame.launch(t,this.config),setTimeout(function(){i.wait=!1},1e3))},window.Paidy={},window.Paidy.configure=function(t){return new A(t)}}();
